package com.uwb.bt2j.aligner.seed;

public class Constraint {
	public Constraint() {
		init();
	}
	
	public void init() {
		edits = mms = ins = dels = penalty = editsCeil = mmsCeil =
				insCeil = delsCeil = penaltyCeil = MAX_I;
				penFunc.reset();
				instantiated = false;
	}
	
	public Boolean mustMatch() {
		return (mms == 0 && edits == 0) ||
		        penalty == 0 ||
		       (mms == 0 && dels == 0 && ins == 0);
	}
	
	public Boolean canMismatch(int q, Scoring cm) {
		return (mms > 0 || edits > 0) &&
			       penalty >= cm.mm(q);
	}
	
	public Constraint exact() {
		Constraint c;
		c.edits = c.mms = c.ins = c.dels = c.penalty = 0;
		return c;
	}
	
	public Constraint penaltyBased(int pen) {
		Constraint c;
		c.penalty = pen;
		return c;
	}
	
	public Constraint penaltyFuncBased(SimpleFunc f) {
		Constraint c;
		c.penFunc = f;
		return c;
	}
	
	public Constraint mmBased(int mms) {
		Constraint c;
		c.mms = mms;
		c.edits = c.dels = c.ins = 0;
		return c;
	}
	
	public Constraint editBased(int edits) {
		Constraint c;
		c.edits = edits;
		c.dels = c.ins = c.mms = 0;
		return c;
	}
}
