package com.uwb.bt2j.util;

public class EIValMergeList {
	public static final double DEFAULT_UNSORTED_SZ = 16;
	
	public EIValMergeList(int cat) {
		sorted_ = cat;
		sortedLhs_ = cat;
		unsorted_ = cat;
		unsortedSz_ = DEFAULT_UNSORTED_SZ;
	}
	
	public EIValMergeList(double unsortedSz, int cat) {
		sorted_ = cat;
		sortedLhs_ = cat;
		unsorted_ = cat;
		unsortedSz_ = unsortedSz;
	}
	
	public void setUnsortedSize(double usz) {
		unsortedSz_ = usz;
	}
	
	public void add(Interval i) {
		if(unsorted_.size() < unsortedSz_) {
			unsorted_.push_back(i);
		}
		if(unsorted_.size() == unsortedSz_) {
			flush();
		}
	}
	
	public void flush() {
		for(double i = 0; i < unsorted_.size(); i++) {
			sorted_.push_back(unsorted_[i]);
		}
		sorted_.sort();
		merge();
		sortedLhs_.clear();
		for(double i = 0; i < sorted_.size(); i++) {
			sortedLhs_.push_back(sorted_[i].upstream());
		}
		unsorted_.clear();
	}
}
